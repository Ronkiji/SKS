[INFO] (utils) Arguments:
[INFO] (utils)   batch_size: 512
[INFO] (utils)   command: train.py -d ../data/SemEval_task5/df_train.csv --trial ../data/SemEval_task5/df_test.csv -s ../data/sentiment_datasets/train_E6oV3lV.csv --word_list ../data/word_list/word_all.txt --emb ../glove.6B.300d.txt -o output_dir -b 512 --epochs 15 --lr 0.002 --maxlen 50 -t HHMM_transformer
[INFO] (utils)   data_path: ../data/SemEval_task5/df_train.csv
[INFO] (utils)   dropout_prob: 0.1
[INFO] (utils)   emb_dim: 300
[INFO] (utils)   emb_path: ../glove.6B.300d.txt
[INFO] (utils)   epochs: 15
[INFO] (utils)   humor_data_path: None
[INFO] (utils)   learn_rate: 0.002
[INFO] (utils)   loss: ce
[INFO] (utils)   maxlen: 50
[INFO] (utils)   model_type: HHMM_transformer
[INFO] (utils)   non_gate: False
[INFO] (utils)   out_dir_path: output_dir
[INFO] (utils)   sarcasm_data_path: None
[INFO] (utils)   sentiment_data_path: ../data/sentiment_datasets/train_E6oV3lV.csv
[INFO] (utils)   trial_data_path: ../data/SemEval_task5/df_test.csv
[INFO] (utils)   vocab_path: None
[INFO] (utils)   word_list_path: ../data/word_list/word_all.txt
[INFO] (utils)   word_norm: 1
[INFO] (data_reader) Creating vocabulary.........
[INFO] (data_reader)   407653 total words, 37044 unique words
[INFO] (data_reader)   Vocab size: 37044
[INFO] (data_reader) <unk> hit rate: 0.00%
[INFO] (data_reader) <unk> hit rate: 0.01%
[INFO] (__main__) Statistics:
[INFO] (__main__)   train_x shape: (27000, 50)
[INFO] (__main__)   test_x shape:  (1320, 50)
[INFO] (__main__)   train_chars shape: (27000, 300)
[INFO] (__main__)   test_chars shape:  (1320, 300)
[INFO] (__main__)   train_y shape: (27000, 2)
[INFO] (__main__)   test_y shape:  (1320, 2)
[INFO] (models) Building a HHMM_transfermer
[INFO] (models)   Done
[INFO] (models) Initializing lookup table
[INFO] (w2vEmbReader) Loading embeddings from: ../glove.6B.300d.txt
[INFO] (w2vEmbReader)   #vectors: 400000, #dimensions: 300
[INFO] (w2vEmbReader) 18832/37044 word vectors initialized (hit rate: 50.84%)
[INFO] (models)   Done
[INFO] (__main__) --------------------------------------------------------------------------------------------------------------------------
[INFO] (__main__) Initial Evaluation:
[INFO] (__main__) Epoch 0, train: 111s, evaluation: 3s, toaal_time: 114s
[INFO] (__main__) [Train] loss: 0.4144, metric: 0.8021
[INFO] (model_evaluator) Evaluation on test data: acc = 0.624000 
[INFO] (model_evaluator) Evaluation on test data: f1_hs = 0.604137 
[INFO] (model_evaluator) Evaluation on test data: f1_hs_wei = 0.630917 
[INFO] (model_evaluator) Evaluation on test data: f1_all = 0.632976 
[INFO] (model_evaluator) --------------------------------------------------------------------------------------------------------------------------
[INFO] (__main__) Epoch 1, train: 109s, evaluation: 2s, toaal_time: 226s
[INFO] (__main__) [Train] loss: 0.3630, metric: 0.8333
[INFO] (model_evaluator) Evaluation on test data: acc = 0.644000 
[INFO] (model_evaluator) Evaluation on test data: f1_hs = 0.639799 
[INFO] (model_evaluator) Evaluation on test data: f1_hs_wei = 0.642522 
[INFO] (model_evaluator) Evaluation on test data: f1_all = 0.673637 
[INFO] (model_evaluator) --------------------------------------------------------------------------------------------------------------------------
[INFO] (__main__) Epoch 2, train: 108s, evaluation: 2s, toaal_time: 337s
[INFO] (__main__) [Train] loss: 0.3395, metric: 0.8415
[INFO] (model_evaluator) Evaluation on test data: acc = 0.644000 
[INFO] (model_evaluator) Evaluation on test data: f1_hs = 0.624479 
[INFO] (model_evaluator) Evaluation on test data: f1_hs_wei = 0.651021 
[INFO] (model_evaluator) Evaluation on test data: f1_all = 0.649789 
[INFO] (model_evaluator) --------------------------------------------------------------------------------------------------------------------------
[INFO] (__main__) Epoch 3, train: 108s, evaluation: 2s, toaal_time: 448s
[INFO] (__main__) [Train] loss: 0.3254, metric: 0.8483
[INFO] (model_evaluator) Evaluation on test data: acc = 0.655000 
[INFO] (model_evaluator) Evaluation on test data: f1_hs = 0.650212 
[INFO] (model_evaluator) Evaluation on test data: f1_hs_wei = 0.653813 
[INFO] (model_evaluator) Evaluation on test data: f1_all = 0.685506 
[INFO] (model_evaluator) --------------------------------------------------------------------------------------------------------------------------
[INFO] (__main__) Epoch 4, train: 109s, evaluation: 2s, toaal_time: 560s
[INFO] (__main__) [Train] loss: 0.3156, metric: 0.8567
[INFO] (model_evaluator) Evaluation on test data: acc = 0.649000 
[INFO] (model_evaluator) Evaluation on test data: f1_hs = 0.604030 
[INFO] (model_evaluator) Evaluation on test data: f1_hs_wei = 0.674487 
[INFO] (model_evaluator) Evaluation on test data: f1_all = 0.627537 
[INFO] (model_evaluator) --------------------------------------------------------------------------------------------------------------------------
[INFO] (__main__) Epoch 5, train: 109s, evaluation: 2s, toaal_time: 672s
[INFO] (__main__) [Train] loss: 0.3073, metric: 0.8641
[INFO] (model_evaluator) Evaluation on test data: acc = 0.663000 
[INFO] (model_evaluator) Evaluation on test data: f1_hs = 0.662189 
[INFO] (model_evaluator) Evaluation on test data: f1_hs_wei = 0.661394 
[INFO] (model_evaluator) Evaluation on test data: f1_all = 0.698949 
[INFO] (model_evaluator) --------------------------------------------------------------------------------------------------------------------------
[INFO] (__main__) Epoch 6, train: 108s, evaluation: 2s, toaal_time: 783s
[INFO] (__main__) [Train] loss: 0.2920, metric: 0.8694
[INFO] (model_evaluator) Evaluation on test data: acc = 0.672000 
[INFO] (model_evaluator) Evaluation on test data: f1_hs = 0.663602 
[INFO] (model_evaluator) Evaluation on test data: f1_hs_wei = 0.672638 
[INFO] (model_evaluator) Evaluation on test data: f1_all = 0.689797 
[INFO] (model_evaluator) --------------------------------------------------------------------------------------------------------------------------
[INFO] (__main__) Epoch 7, train: 110s, evaluation: 2s, toaal_time: 896s
[INFO] (__main__) [Train] loss: 0.2868, metric: 0.8715
[INFO] (model_evaluator) Evaluation on test data: acc = 0.668000 
[INFO] (model_evaluator) Evaluation on test data: f1_hs = 0.667839 
[INFO] (model_evaluator) Evaluation on test data: f1_hs_wei = 0.667094 
[INFO] (model_evaluator) Evaluation on test data: f1_all = 0.709642 
[INFO] (model_evaluator) --------------------------------------------------------------------------------------------------------------------------
[INFO] (__main__) Epoch 8, train: 108s, evaluation: 2s, toaal_time: 1007s
[INFO] (__main__) [Train] loss: 0.2783, metric: 0.8761
[INFO] (model_evaluator) Evaluation on test data: acc = 0.685000 
[INFO] (model_evaluator) Evaluation on test data: f1_hs = 0.668203 
[INFO] (model_evaluator) Evaluation on test data: f1_hs_wei = 0.690898 
[INFO] (model_evaluator) Evaluation on test data: f1_all = 0.695803 
[INFO] (model_evaluator) --------------------------------------------------------------------------------------------------------------------------
[INFO] (__main__) Epoch 9, train: 111s, evaluation: 2s, toaal_time: 1121s
[INFO] (__main__) [Train] loss: 0.2670, metric: 0.8839
[INFO] (model_evaluator) Evaluation on test data: acc = 0.675000 
[INFO] (model_evaluator) Evaluation on test data: f1_hs = 0.668408 
[INFO] (model_evaluator) Evaluation on test data: f1_hs_wei = 0.674766 
[INFO] (model_evaluator) Evaluation on test data: f1_all = 0.700757 
[INFO] (model_evaluator) --------------------------------------------------------------------------------------------------------------------------
[INFO] (__main__) Epoch 10, train: 110s, evaluation: 2s, toaal_time: 1234s
[INFO] (__main__) [Train] loss: 0.2622, metric: 0.8856
[INFO] (model_evaluator) Evaluation on test data: acc = 0.688000 
[INFO] (model_evaluator) Evaluation on test data: f1_hs = 0.682295 
[INFO] (model_evaluator) Evaluation on test data: f1_hs_wei = 0.687489 
[INFO] (model_evaluator) Evaluation on test data: f1_all = 0.714422 
[INFO] (model_evaluator) --------------------------------------------------------------------------------------------------------------------------
[INFO] (__main__) Epoch 11, train: 112s, evaluation: 2s, toaal_time: 1349s
[INFO] (__main__) [Train] loss: 0.2524, metric: 0.8917
[INFO] (model_evaluator) Evaluation on test data: acc = 0.688000 
[INFO] (model_evaluator) Evaluation on test data: f1_hs = 0.675269 
[INFO] (model_evaluator) Evaluation on test data: f1_hs_wei = 0.691343 
[INFO] (model_evaluator) Evaluation on test data: f1_all = 0.700281 
[INFO] (model_evaluator) --------------------------------------------------------------------------------------------------------------------------
[INFO] (__main__) Epoch 12, train: 108s, evaluation: 2s, toaal_time: 1461s
[INFO] (__main__) [Train] loss: 0.2438, metric: 0.8969
[INFO] (model_evaluator) Evaluation on test data: acc = 0.670000 
[INFO] (model_evaluator) Evaluation on test data: f1_hs = 0.662813 
[INFO] (model_evaluator) Evaluation on test data: f1_hs_wei = 0.670000 
[INFO] (model_evaluator) Evaluation on test data: f1_all = 0.695679 
[INFO] (model_evaluator) --------------------------------------------------------------------------------------------------------------------------
[INFO] (__main__) Epoch 13, train: 111s, evaluation: 2s, toaal_time: 1575s
[INFO] (__main__) [Train] loss: 0.2366, metric: 0.9000
[INFO] (model_evaluator) Evaluation on test data: acc = 0.676000 
[INFO] (model_evaluator) Evaluation on test data: f1_hs = 0.674981 
[INFO] (model_evaluator) Evaluation on test data: f1_hs_wei = 0.674362 
[INFO] (model_evaluator) Evaluation on test data: f1_all = 0.714625 
[INFO] (model_evaluator) --------------------------------------------------------------------------------------------------------------------------
[INFO] (__main__) Epoch 14, train: 109s, evaluation: 2s, toaal_time: 1687s
[INFO] (__main__) [Train] loss: 0.2311, metric: 0.9026
[INFO] (model_evaluator) Evaluation on test data: acc = 0.679000 
[INFO] (model_evaluator) Evaluation on test data: f1_hs = 0.673041 
[INFO] (model_evaluator) Evaluation on test data: f1_hs_wei = 0.678514 
[INFO] (model_evaluator) Evaluation on test data: f1_all = 0.706960 
[INFO] (model_evaluator) --------------------------------------------------------------------------------------------------------------------------
[INFO] (__main__) Training:   1648 seconds in total
[INFO] (__main__) Evaluation: 39 seconds in total
[INFO] (model_evaluator) --------------------------------------------------------------------------------------------------------------------------
[INFO] (model_evaluator) Best @ Epoch 10:
[INFO] (model_evaluator) BestF1 0.682295 
[INFO] (model_evaluator)   [TEST] report               precision    recall  f1-score   support

           0       0.72      0.73      0.72       561
           1       0.65      0.63      0.64       439

    accuracy                           0.69      1000
   macro avg       0.68      0.68      0.68      1000
weighted avg       0.69      0.69      0.69      1000

