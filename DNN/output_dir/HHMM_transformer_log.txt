[INFO] (utils) Arguments:
[INFO] (utils)   batch_size: 512
[INFO] (utils)   command: train.py -d ../data/SemEval_task5/df_train.csv --trial ../data/SemEval_task5/df_test.csv -s ../data/sentiment_datasets/train_E6oV3lV.csv --word_list ../data/word_list/word_all.txt --emb ../glove.6B.300d.txt -o output_dir -b 512 --epochs 15 --lr 0.002 --maxlen 50 -t HHMM_transformer
[INFO] (utils)   data_path: ../data/SemEval_task5/df_train.csv
[INFO] (utils)   dropout_prob: 0.1
[INFO] (utils)   emb_dim: 300
[INFO] (utils)   emb_path: ../glove.6B.300d.txt
[INFO] (utils)   epochs: 15
[INFO] (utils)   humor_data_path: None
[INFO] (utils)   learn_rate: 0.002
[INFO] (utils)   loss: ce
[INFO] (utils)   maxlen: 50
[INFO] (utils)   model_type: HHMM_transformer
[INFO] (utils)   non_gate: False
[INFO] (utils)   out_dir_path: output_dir
[INFO] (utils)   sarcasm_data_path: None
[INFO] (utils)   sentiment_data_path: ../data/sentiment_datasets/train_E6oV3lV.csv
[INFO] (utils)   trial_data_path: ../data/SemEval_task5/df_test.csv
[INFO] (utils)   vocab_path: None
[INFO] (utils)   word_list_path: ../data/word_list/word_all.txt
[INFO] (utils)   word_norm: 1
[INFO] (data_reader) Creating vocabulary.........
[INFO] (data_reader)   407653 total words, 37044 unique words
[INFO] (data_reader)   Vocab size: 37044
[INFO] (data_reader) <unk> hit rate: 0.00%
[INFO] (data_reader) <unk> hit rate: 0.01%
[INFO] (__main__) Statistics:
[INFO] (__main__)   train_x shape: (27000, 50)
[INFO] (__main__)   test_x shape:  (1320, 50)
[INFO] (__main__)   train_chars shape: (27000, 300)
[INFO] (__main__)   test_chars shape:  (1320, 300)
[INFO] (__main__)   train_y shape: (27000, 2)
[INFO] (__main__)   test_y shape:  (1320, 2)
[INFO] (models) Building a HHMM_transfermer
[WARNING] (tensorflow) From C:\Users\ronpl\AppData\Local\Programs\Python\Python311\Lib\site-packages\keras\src\backend\tensorflow\core.py:170: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

[INFO] (models)   Done
[INFO] (models) Initializing lookup table
[INFO] (w2vEmbReader) Loading embeddings from: ../glove.6B.300d.txt
[INFO] (w2vEmbReader)   #vectors: 400000, #dimensions: 300
[INFO] (w2vEmbReader) 18832/37044 word vectors initialized (hit rate: 50.84%)
[INFO] (models)   Done
[INFO] (__main__) --------------------------------------------------------------------------------------------------------------------------
[INFO] (__main__) Initial Evaluation:
[INFO] (__main__) Epoch 0, train: 119s, evaluation: 3s, toaal_time: 123s
[INFO] (__main__) [Train] loss: 0.4089, metric: 0.8207
[INFO] (model_evaluator) Evaluation on test data: acc = 0.624000 
[INFO] (model_evaluator) Evaluation on test data: f1_hs = 0.603762 
[INFO] (model_evaluator) Evaluation on test data: f1_hs_wei = 0.631164 
[INFO] (model_evaluator) Evaluation on test data: f1_all = 0.632473 
[INFO] (model_evaluator) --------------------------------------------------------------------------------------------------------------------------
[INFO] (__main__) Epoch 1, train: 115s, evaluation: 2s, toaal_time: 241s
[INFO] (__main__) [Train] loss: 0.3826, metric: 0.8349
[INFO] (model_evaluator) Evaluation on test data: acc = 0.623000 
[INFO] (model_evaluator) Evaluation on test data: f1_hs = 0.541786 
[INFO] (model_evaluator) Evaluation on test data: f1_hs_wei = 0.676050 
[INFO] (model_evaluator) Evaluation on test data: f1_all = 0.561688 
[INFO] (model_evaluator) --------------------------------------------------------------------------------------------------------------------------
[INFO] (__main__) Epoch 2, train: 113s, evaluation: 2s, toaal_time: 357s
[INFO] (__main__) [Train] loss: 0.3735, metric: 0.8356
[INFO] (model_evaluator) Evaluation on test data: acc = 0.639000 
[INFO] (model_evaluator) Evaluation on test data: f1_hs = 0.607086 
[INFO] (model_evaluator) Evaluation on test data: f1_hs_wei = 0.654565 
[INFO] (model_evaluator) Evaluation on test data: f1_all = 0.629970 
[INFO] (model_evaluator) --------------------------------------------------------------------------------------------------------------------------
[INFO] (__main__) Epoch 3, train: 108s, evaluation: 2s, toaal_time: 467s
[INFO] (__main__) [Train] loss: 0.3663, metric: 0.8400
[INFO] (model_evaluator) Evaluation on test data: acc = 0.640000 
[INFO] (model_evaluator) Evaluation on test data: f1_hs = 0.619892 
[INFO] (model_evaluator) Evaluation on test data: f1_hs_wei = 0.647344 
[INFO] (model_evaluator) Evaluation on test data: f1_all = 0.645735 
[INFO] (model_evaluator) --------------------------------------------------------------------------------------------------------------------------
[INFO] (__main__) Epoch 4, train: 104s, evaluation: 2s, toaal_time: 574s
[INFO] (__main__) [Train] loss: 0.3603, metric: 0.8396
[INFO] (model_evaluator) Evaluation on test data: acc = 0.651000 
[INFO] (model_evaluator) Evaluation on test data: f1_hs = 0.644124 
[INFO] (model_evaluator) Evaluation on test data: f1_hs_wei = 0.650654 
[INFO] (model_evaluator) Evaluation on test data: f1_all = 0.674286 
[INFO] (model_evaluator) --------------------------------------------------------------------------------------------------------------------------
[INFO] (__main__) Epoch 5, train: 98s, evaluation: 2s, toaal_time: 675s
[INFO] (__main__) [Train] loss: 0.3543, metric: 0.8439
[INFO] (model_evaluator) Evaluation on test data: acc = 0.654000 
[INFO] (model_evaluator) Evaluation on test data: f1_hs = 0.651422 
[INFO] (model_evaluator) Evaluation on test data: f1_hs_wei = 0.652201 
[INFO] (model_evaluator) Evaluation on test data: f1_all = 0.685252 
[INFO] (model_evaluator) --------------------------------------------------------------------------------------------------------------------------
[INFO] (__main__) Epoch 6, train: 99s, evaluation: 2s, toaal_time: 776s
[INFO] (__main__) [Train] loss: 0.3394, metric: 0.8453
[INFO] (model_evaluator) Evaluation on test data: acc = 0.649000 
[INFO] (model_evaluator) Evaluation on test data: f1_hs = 0.616527 
[INFO] (model_evaluator) Evaluation on test data: f1_hs_wei = 0.665181 
[INFO] (model_evaluator) Evaluation on test data: f1_all = 0.637518 
[INFO] (model_evaluator) --------------------------------------------------------------------------------------------------------------------------
[INFO] (__main__) Epoch 7, train: 101s, evaluation: 2s, toaal_time: 880s
[INFO] (__main__) [Train] loss: 0.3217, metric: 0.8563
[INFO] (model_evaluator) Evaluation on test data: acc = 0.666000 
[INFO] (model_evaluator) Evaluation on test data: f1_hs = 0.635331 
[INFO] (model_evaluator) Evaluation on test data: f1_hs_wei = 0.681229 
[INFO] (model_evaluator) Evaluation on test data: f1_all = 0.653681 
[INFO] (model_evaluator) --------------------------------------------------------------------------------------------------------------------------
[INFO] (__main__) Epoch 8, train: 102s, evaluation: 2s, toaal_time: 985s
[INFO] (__main__) [Train] loss: 0.3025, metric: 0.8659
[INFO] (model_evaluator) Evaluation on test data: acc = 0.672000 
[INFO] (model_evaluator) Evaluation on test data: f1_hs = 0.648610 
[INFO] (model_evaluator) Evaluation on test data: f1_hs_wei = 0.682154 
[INFO] (model_evaluator) Evaluation on test data: f1_all = 0.669797 
[INFO] (model_evaluator) --------------------------------------------------------------------------------------------------------------------------
[INFO] (__main__) Epoch 9, train: 99s, evaluation: 2s, toaal_time: 1087s
[INFO] (__main__) [Train] loss: 0.2916, metric: 0.8689
[INFO] (model_evaluator) Evaluation on test data: acc = 0.664000 
[INFO] (model_evaluator) Evaluation on test data: f1_hs = 0.627765 
[INFO] (model_evaluator) Evaluation on test data: f1_hs_wei = 0.683279 
[INFO] (model_evaluator) Evaluation on test data: f1_all = 0.656759 
[INFO] (model_evaluator) --------------------------------------------------------------------------------------------------------------------------
[INFO] (__main__) Epoch 10, train: 98s, evaluation: 2s, toaal_time: 1187s
[INFO] (__main__) [Train] loss: 0.2854, metric: 0.8749
[INFO] (model_evaluator) Evaluation on test data: acc = 0.674000 
[INFO] (model_evaluator) Evaluation on test data: f1_hs = 0.669075 
[INFO] (model_evaluator) Evaluation on test data: f1_hs_wei = 0.673031 
[INFO] (model_evaluator) Evaluation on test data: f1_all = 0.700894 
[INFO] (model_evaluator) --------------------------------------------------------------------------------------------------------------------------
[INFO] (__main__) Epoch 11, train: 97s, evaluation: 2s, toaal_time: 1287s
[INFO] (__main__) [Train] loss: 0.2736, metric: 0.8806
[INFO] (model_evaluator) Evaluation on test data: acc = 0.681000 
[INFO] (model_evaluator) Evaluation on test data: f1_hs = 0.677712 
[INFO] (model_evaluator) Evaluation on test data: f1_hs_wei = 0.679535 
[INFO] (model_evaluator) Evaluation on test data: f1_all = 0.712076 
[INFO] (model_evaluator) --------------------------------------------------------------------------------------------------------------------------
[INFO] (__main__) Epoch 12, train: 97s, evaluation: 2s, toaal_time: 1387s
[INFO] (__main__) [Train] loss: 0.2679, metric: 0.8823
[INFO] (model_evaluator) Evaluation on test data: acc = 0.666000 
[INFO] (model_evaluator) Evaluation on test data: f1_hs = 0.666000 
[INFO] (model_evaluator) Evaluation on test data: f1_hs_wei = 0.666000 
[INFO] (model_evaluator) Evaluation on test data: f1_all = 0.710109 
[INFO] (model_evaluator) --------------------------------------------------------------------------------------------------------------------------
[INFO] (__main__) Epoch 13, train: 98s, evaluation: 2s, toaal_time: 1487s
[INFO] (__main__) [Train] loss: 0.2599, metric: 0.8854
[INFO] (model_evaluator) Evaluation on test data: acc = 0.659000 
[INFO] (model_evaluator) Evaluation on test data: f1_hs = 0.658582 
[INFO] (model_evaluator) Evaluation on test data: f1_hs_wei = 0.657674 
[INFO] (model_evaluator) Evaluation on test data: f1_all = 0.702088 
[INFO] (model_evaluator) --------------------------------------------------------------------------------------------------------------------------
[INFO] (__main__) Epoch 14, train: 98s, evaluation: 2s, toaal_time: 1589s
[INFO] (__main__) [Train] loss: 0.2566, metric: 0.8889
[INFO] (model_evaluator) Evaluation on test data: acc = 0.679000 
[INFO] (model_evaluator) Evaluation on test data: f1_hs = 0.661883 
[INFO] (model_evaluator) Evaluation on test data: f1_hs_wei = 0.685010 
[INFO] (model_evaluator) Evaluation on test data: f1_all = 0.687200 
[INFO] (model_evaluator) --------------------------------------------------------------------------------------------------------------------------
[INFO] (__main__) Training:   1552 seconds in total
[INFO] (__main__) Evaluation: 36 seconds in total
[INFO] (model_evaluator) --------------------------------------------------------------------------------------------------------------------------
[INFO] (model_evaluator) Best @ Epoch 11:
[INFO] (model_evaluator) BestF1 0.677712 
[INFO] (model_evaluator)   [TEST] report               precision    recall  f1-score   support

           0       0.68      0.74      0.71       528
           1       0.68      0.61      0.65       472

    accuracy                           0.68      1000
   macro avg       0.68      0.68      0.68      1000
weighted avg       0.68      0.68      0.68      1000

