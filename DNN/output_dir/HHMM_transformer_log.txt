[INFO] (utils) Arguments:
[INFO] (utils)   batch_size: 512
[INFO] (utils)   command: train.py -d ../data/SemEval_task5/df_train.csv --trial ../data/SemEval_task5/df_test.csv -s ../data/sentiment_datasets/train_E6oV3lV.csv --word_list ../data/word_list/word_all.txt --emb ../glove.6B.300d.txt -o output_dir -b 512 --epochs 15 --lr 0.002 --maxlen 50 -t HHMM_transformer
[INFO] (utils)   data_path: ../data/SemEval_task5/df_train.csv
[INFO] (utils)   dropout_prob: 0.1
[INFO] (utils)   emb_dim: 300
[INFO] (utils)   emb_path: ../glove.6B.300d.txt
[INFO] (utils)   epochs: 15
[INFO] (utils)   humor_data_path: None
[INFO] (utils)   learn_rate: 0.002
[INFO] (utils)   loss: ce
[INFO] (utils)   maxlen: 50
[INFO] (utils)   model_type: HHMM_transformer
[INFO] (utils)   non_gate: False
[INFO] (utils)   out_dir_path: output_dir
[INFO] (utils)   sarcasm_data_path: None
[INFO] (utils)   sentiment_data_path: ../data/sentiment_datasets/train_E6oV3lV.csv
[INFO] (utils)   trial_data_path: ../data/SemEval_task5/df_test.csv
[INFO] (utils)   vocab_path: None
[INFO] (utils)   word_list_path: ../data/word_list/word_all.txt
[INFO] (utils)   word_norm: 1
[INFO] (data_reader) Creating vocabulary.........
[INFO] (data_reader)   407653 total words, 37044 unique words
[INFO] (data_reader)   Vocab size: 37044
[INFO] (data_reader) <unk> hit rate: 0.00%
[INFO] (data_reader) <unk> hit rate: 0.01%
[INFO] (__main__) Statistics:
[INFO] (__main__)   train_x shape: (27000, 50)
[INFO] (__main__)   test_x shape:  (1320, 50)
[INFO] (__main__)   train_chars shape: (27000, 300)
[INFO] (__main__)   test_chars shape:  (1320, 300)
[INFO] (__main__)   train_y shape: (27000, 2)
[INFO] (__main__)   test_y shape:  (1320, 2)
[INFO] (models) Building a HHMM_transfermer
[WARNING] (tensorflow) From C:\Users\Aryan Chawla\cisc452\SKS\venv\Lib\site-packages\keras\src\backend.py:1398: The name tf.executing_eagerly_outside_functions is deprecated. Please use tf.compat.v1.executing_eagerly_outside_functions instead.

[INFO] (models)   Done
[INFO] (models) Initializing lookup table
[INFO] (w2vEmbReader) Loading embeddings from: ../glove.6B.300d.txt
[INFO] (w2vEmbReader)   #vectors: 400000, #dimensions: 300
[INFO] (w2vEmbReader) 18832/37044 word vectors initialized (hit rate: 50.84%)
[INFO] (models)   Done
[WARNING] (tensorflow) From C:\Users\Aryan Chawla\cisc452\SKS\venv\Lib\site-packages\keras\src\optimizers\__init__.py:309: The name tf.train.Optimizer is deprecated. Please use tf.compat.v1.train.Optimizer instead.

[INFO] (__main__) --------------------------------------------------------------------------------------------------------------------------
[INFO] (__main__) Initial Evaluation:
[WARNING] (tensorflow) From C:\Users\Aryan Chawla\cisc452\SKS\venv\Lib\site-packages\keras\src\utils\tf_utils.py:492: The name tf.ragged.RaggedTensorValue is deprecated. Please use tf.compat.v1.ragged.RaggedTensorValue instead.

[WARNING] (tensorflow) From C:\Users\Aryan Chawla\cisc452\SKS\venv\Lib\site-packages\keras\src\engine\base_layer_utils.py:384: The name tf.executing_eagerly_outside_functions is deprecated. Please use tf.compat.v1.executing_eagerly_outside_functions instead.

[INFO] (__main__) Epoch 0, train: 199s, evaluation: 7s, toaal_time: 207s
[INFO] (__main__) [Train] loss: 0.4084, metric: 0.8157
[INFO] (model_evaluator) Evaluation on test data: acc = 0.626000 
[INFO] (model_evaluator) Evaluation on test data: f1_hs = 0.606978 
[INFO] (model_evaluator) Evaluation on test data: f1_hs_wei = 0.632398 
[INFO] (model_evaluator) Evaluation on test data: f1_all = 0.635744 
[INFO] (model_evaluator) --------------------------------------------------------------------------------------------------------------------------
[INFO] (__main__) Epoch 1, train: 190s, evaluation: 5s, toaal_time: 404s
[INFO] (__main__) [Train] loss: 0.3591, metric: 0.8356
[INFO] (model_evaluator) Evaluation on test data: acc = 0.641000 
[INFO] (model_evaluator) Evaluation on test data: f1_hs = 0.636842 
[INFO] (model_evaluator) Evaluation on test data: f1_hs_wei = 0.639485 
[INFO] (model_evaluator) Evaluation on test data: f1_all = 0.671307 
[INFO] (model_evaluator) --------------------------------------------------------------------------------------------------------------------------
[INFO] (__main__) Epoch 2, train: 191s, evaluation: 5s, toaal_time: 601s
[INFO] (__main__) [Train] loss: 0.3363, metric: 0.8432
[INFO] (model_evaluator) Evaluation on test data: acc = 0.644000 
[INFO] (model_evaluator) Evaluation on test data: f1_hs = 0.598083 
[INFO] (model_evaluator) Evaluation on test data: f1_hs_wei = 0.670083 
[INFO] (model_evaluator) Evaluation on test data: f1_all = 0.617648 
[INFO] (model_evaluator) --------------------------------------------------------------------------------------------------------------------------
[INFO] (__main__) Epoch 3, train: 192s, evaluation: 5s, toaal_time: 799s
[INFO] (__main__) [Train] loss: 0.3228, metric: 0.8464
[INFO] (model_evaluator) Evaluation on test data: acc = 0.665000 
[INFO] (model_evaluator) Evaluation on test data: f1_hs = 0.634930 
[INFO] (model_evaluator) Evaluation on test data: f1_hs_wei = 0.679773 
[INFO] (model_evaluator) Evaluation on test data: f1_all = 0.660145 
[INFO] (model_evaluator) --------------------------------------------------------------------------------------------------------------------------
[INFO] (__main__) Epoch 4, train: 194s, evaluation: 6s, toaal_time: 1000s
[INFO] (__main__) [Train] loss: 0.3135, metric: 0.8541
[INFO] (model_evaluator) Evaluation on test data: acc = 0.666000 
[INFO] (model_evaluator) Evaluation on test data: f1_hs = 0.648356 
[INFO] (model_evaluator) Evaluation on test data: f1_hs_wei = 0.672144 
[INFO] (model_evaluator) Evaluation on test data: f1_all = 0.673845 
[INFO] (model_evaluator) --------------------------------------------------------------------------------------------------------------------------
[INFO] (__main__) Epoch 5, train: 205s, evaluation: 6s, toaal_time: 1212s
[INFO] (__main__) [Train] loss: 0.3051, metric: 0.8616
[INFO] (model_evaluator) Evaluation on test data: acc = 0.674000 
[INFO] (model_evaluator) Evaluation on test data: f1_hs = 0.642694 
[INFO] (model_evaluator) Evaluation on test data: f1_hs_wei = 0.689864 
[INFO] (model_evaluator) Evaluation on test data: f1_all = 0.664243 
[INFO] (model_evaluator) --------------------------------------------------------------------------------------------------------------------------
[INFO] (__main__) Epoch 6, train: 204s, evaluation: 6s, toaal_time: 1423s
[INFO] (__main__) [Train] loss: 0.2931, metric: 0.8680
[INFO] (model_evaluator) Evaluation on test data: acc = 0.658000 
[INFO] (model_evaluator) Evaluation on test data: f1_hs = 0.650758 
[INFO] (model_evaluator) Evaluation on test data: f1_hs_wei = 0.657899 
[INFO] (model_evaluator) Evaluation on test data: f1_all = 0.681708 
[INFO] (model_evaluator) --------------------------------------------------------------------------------------------------------------------------
[INFO] (__main__) Epoch 7, train: 197s, evaluation: 5s, toaal_time: 1626s
[INFO] (__main__) [Train] loss: 0.2845, metric: 0.8739
[INFO] (model_evaluator) Evaluation on test data: acc = 0.673000 
[INFO] (model_evaluator) Evaluation on test data: f1_hs = 0.656527 
[INFO] (model_evaluator) Evaluation on test data: f1_hs_wei = 0.678491 
[INFO] (model_evaluator) Evaluation on test data: f1_all = 0.681410 
[INFO] (model_evaluator) --------------------------------------------------------------------------------------------------------------------------
[INFO] (__main__) Epoch 8, train: 192s, evaluation: 5s, toaal_time: 1824s
[INFO] (__main__) [Train] loss: 0.2746, metric: 0.8786
[INFO] (model_evaluator) Evaluation on test data: acc = 0.639000 
[INFO] (model_evaluator) Evaluation on test data: f1_hs = 0.636958 
[INFO] (model_evaluator) Evaluation on test data: f1_hs_wei = 0.645017 
[INFO] (model_evaluator) Evaluation on test data: f1_all = 0.692248 
[INFO] (model_evaluator) --------------------------------------------------------------------------------------------------------------------------
[INFO] (__main__) Epoch 9, train: 196s, evaluation: 5s, toaal_time: 2026s
[INFO] (__main__) [Train] loss: 0.2679, metric: 0.8811
[INFO] (model_evaluator) Evaluation on test data: acc = 0.660000 
[INFO] (model_evaluator) Evaluation on test data: f1_hs = 0.659966 
[INFO] (model_evaluator) Evaluation on test data: f1_hs_wei = 0.659538 
[INFO] (model_evaluator) Evaluation on test data: f1_all = 0.703810 
[INFO] (model_evaluator) --------------------------------------------------------------------------------------------------------------------------
[INFO] (__main__) Epoch 10, train: 193s, evaluation: 5s, toaal_time: 2226s
[INFO] (__main__) [Train] loss: 0.2569, metric: 0.8855
[INFO] (model_evaluator) Evaluation on test data: acc = 0.660000 
[INFO] (model_evaluator) Evaluation on test data: f1_hs = 0.659988 
[INFO] (model_evaluator) Evaluation on test data: f1_hs_wei = 0.660310 
[INFO] (model_evaluator) Evaluation on test data: f1_all = 0.703600 
[INFO] (model_evaluator) --------------------------------------------------------------------------------------------------------------------------
[INFO] (__main__) Epoch 11, train: 192s, evaluation: 5s, toaal_time: 2424s
[INFO] (__main__) [Train] loss: 0.2538, metric: 0.8910
[INFO] (model_evaluator) Evaluation on test data: acc = 0.666000 
[INFO] (model_evaluator) Evaluation on test data: f1_hs = 0.665613 
[INFO] (model_evaluator) Evaluation on test data: f1_hs_wei = 0.664727 
[INFO] (model_evaluator) Evaluation on test data: f1_all = 0.705629 
[INFO] (model_evaluator) --------------------------------------------------------------------------------------------------------------------------
[INFO] (__main__) Epoch 12, train: 192s, evaluation: 5s, toaal_time: 2622s
[INFO] (__main__) [Train] loss: 0.2464, metric: 0.8927
[INFO] (model_evaluator) Evaluation on test data: acc = 0.681000 
[INFO] (model_evaluator) Evaluation on test data: f1_hs = 0.679097 
[INFO] (model_evaluator) Evaluation on test data: f1_hs_wei = 0.679295 
[INFO] (model_evaluator) Evaluation on test data: f1_all = 0.710940 
[INFO] (model_evaluator) --------------------------------------------------------------------------------------------------------------------------
[INFO] (__main__) Epoch 13, train: 192s, evaluation: 5s, toaal_time: 2820s
[INFO] (__main__) [Train] loss: 0.2340, metric: 0.9023
[INFO] (model_evaluator) Evaluation on test data: acc = 0.700000 
[INFO] (model_evaluator) Evaluation on test data: f1_hs = 0.674873 
[INFO] (model_evaluator) Evaluation on test data: f1_hs_wei = 0.711931 
[INFO] (model_evaluator) Evaluation on test data: f1_all = 0.693836 
[INFO] (model_evaluator) --------------------------------------------------------------------------------------------------------------------------
[INFO] (__main__) Epoch 14, train: 192s, evaluation: 5s, toaal_time: 3018s
[INFO] (__main__) [Train] loss: 0.2297, metric: 0.9029
[INFO] (model_evaluator) Evaluation on test data: acc = 0.677000 
[INFO] (model_evaluator) Evaluation on test data: f1_hs = 0.676345 
[INFO] (model_evaluator) Evaluation on test data: f1_hs_wei = 0.675529 
[INFO] (model_evaluator) Evaluation on test data: f1_all = 0.717767 
[INFO] (model_evaluator) --------------------------------------------------------------------------------------------------------------------------
[INFO] (__main__) Training:   2927 seconds in total
[INFO] (__main__) Evaluation: 91 seconds in total
[INFO] (model_evaluator) --------------------------------------------------------------------------------------------------------------------------
[INFO] (model_evaluator) Best @ Epoch 12:
[INFO] (model_evaluator) BestF1 0.679097 
[INFO] (model_evaluator)   [TEST] report               precision    recall  f1-score   support

           0       0.66      0.75      0.70       504
           1       0.71      0.61      0.65       496

    accuracy                           0.68      1000
   macro avg       0.68      0.68      0.68      1000
weighted avg       0.68      0.68      0.68      1000

